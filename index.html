<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>Spin Wheel</title>
	<link rel="stylesheet" href="./style.css" />
</head>

<body>
	<div class="container">
		<div class="spin-btn"></div>
		<div class="wheel" id="wheel">
			<!-- CÃ¡c pháº§n tá»­ sáº½ Ä‘Æ°á»£c táº¡o báº±ng JavaScript -->
		</div>
	</div>
	<script>
		// Táº¡o cÃ¡c pháº§n tá»­ wheel
		const wheel = document.getElementById('wheel');
		const colors = ['#013817', '#B6CCBE', '#376048', '#E8E6E3'];
		const percentages = [5, 10, 15, 5, 10, 15, 5, 10, 15, 5, 10, 15, 5, 10, 15, 5, 10, 15, 5, 10, 15, 5, 10, 15, 5, 10, 15, 5, 10, 20];

		for (let i = 0; i < 30; i++) {
			const number = document.createElement('div');
			number.className = 'number';
			number.style.setProperty('--i', i);
			number.style.setProperty('--clr', colors[i % 4]);
			number.innerHTML = `<span>${percentages[i]}%</span>`;
			wheel.appendChild(number);
		}
		let spinBtn = document.querySelector('.spin-btn');
		let value = Math.ceil(Math.random() * 3600);
		let hasWon20Percent = false;
		let spinCount = 0; // Äáº¿m sá»‘ láº§n quay
		let winSpinNumber = 2; // Chá»‰ Ä‘á»‹nh láº§n quay sáº½ trÃºng 20%

		// HÃ m xÃ¡c Ä‘á»‹nh pháº§n trÄƒm trÃºng thÆ°á»Ÿng dá»±a trÃªn gÃ³c
		function getPrizePercentage(angle) {
			// Chuáº©n hÃ³a gÃ³c vá» khoáº£ng 0-360
			angle = angle % 360;
			
			// Máº£ng lÆ°u trá»¯ cÃ¡c khoáº£ng gÃ³c
			const angleRanges = [
				{ start: 0, end: 3 },    // 4
				{ start: 4, end: 15 },   // 3
				{ start: 16, end: 27 },  // 2
				{ start: 28, end: 39 },  // 1
				{ start: 40, end: 51 },  // 0
				{ start: 52, end: 63 },  // 29
				{ start: 64, end: 75 },  // 28
				{ start: 76, end: 87 },  // 27
				{ start: 88, end: 99 },  // 26
				{ start: 100, end: 111 }, // 25
				{ start: 112, end: 123 }, // 24
				{ start: 124, end: 135 }, // 23
				{ start: 136, end: 147 }, // 22
				{ start: 148, end: 159 }, // 21
				{ start: 160, end: 171 }, // 20
				{ start: 172, end: 183 }, // 19
				{ start: 184, end: 195 }, // 18
				{ start: 196, end: 207 }, // 17
				{ start: 208, end: 219 }, // 16
				{ start: 220, end: 231 }, // 15
				{ start: 232, end: 243 }, // 14
				{ start: 244, end: 255 }, // 13
				{ start: 256, end: 267 }, // 12
				{ start: 268, end: 279 }, // 11
				{ start: 280, end: 291 }, // 10
				{ start: 292, end: 303 }, // 9
				{ start: 304, end: 315 }, // 8
				{ start: 316, end: 327 }, // 7
				{ start: 328, end: 339 }, // 6
				{ start: 340, end: 351 }, // 5
				{ start: 352, end: 360 }  // 4
			];

			// TÃ¬m khoáº£ng gÃ³c phÃ¹ há»£p
			const rangeIndex = angleRanges.findIndex(range => angle >= range.start && angle < range.end);
			
			// Náº¿u tÃ¬m tháº¥y khoáº£ng gÃ³c, láº¥y pháº§n trÄƒm tÆ°Æ¡ng á»©ng tá»« máº£ng percentages
			if (rangeIndex !== -1) {
				// TÃ­nh index trong máº£ng percentages (ngÆ°á»£c láº¡i)
				const percentagesIndex = (4 - rangeIndex + 30) % 30;
				return percentages[percentagesIndex];
			}
			
			return 0;
		}

		// HÃ m hiá»ƒn thá»‹ popup
		function showPopup(message) {
			const popup = document.createElement('div');
			popup.style.position = 'fixed';
			popup.style.top = '50%';
			popup.style.left = '50%';
			popup.style.transform = 'translate(-50%, -50%)';
			popup.style.backgroundColor = 'rgba(0, 0, 0, 0.8)';
			popup.style.color = 'white';
			popup.style.padding = '20px';
			popup.style.borderRadius = '10px';
			popup.style.zIndex = '1000';
			popup.style.textAlign = 'center';
			popup.innerHTML = message;

			document.body.appendChild(popup);

			// Tá»± Ä‘á»™ng Ä‘Ã³ng popup sau 3 giÃ¢y
			setTimeout(() => {
				popup.remove();
			}, 3000);
		}

		spinBtn.onclick = () => {
			spinCount++; // TÄƒng sá»‘ láº§n quay

			if (spinCount === winSpinNumber) {
				// Láº§n quay Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh sáº½ trÃºng 20%
				value = Math.floor(Math.random() * (62 - 52 + 1)) + 52;
				hasWon20Percent = true;
			} else {
				// CÃ¡c láº§n quay khÃ¡c sáº½ khÃ´ng trÃºng 20%
				let newValue;
				do {
					newValue = Math.ceil(Math.random() * 3600);
					// TÃ­nh toÃ¡n gÃ³c quay Ä‘á»ƒ trÃ¡nh pháº§n 20%
					let finalAngle = (value + newValue) % 360;
					// Pháº§n 20% náº±m á»Ÿ gÃ³c 52-62 Ä‘á»™
					if (finalAngle < 52 || finalAngle > 62) {
						value = newValue;
						break;
					}
				} while (true);
			}

			wheel.style.transform = `rotate(${value}deg)`;

			// Hiá»ƒn thá»‹ popup sau khi quay xong
			setTimeout(() => {
				const finalAngle = value % 360;
				const prizePercentage = getPrizePercentage(finalAngle);
				if (prizePercentage > 0) {
					showPopup(`ğŸ‰ ChÃºc má»«ng! Báº¡n Ä‘Ã£ trÃºng ${prizePercentage}% ğŸ‰`);
				} else {
					showPopup(`Vui lÃ²ng quay láº¡i`);
				}
			}, 5000); // Äá»£i 3 giÃ¢y Ä‘á»ƒ vÃ²ng quay dá»«ng láº¡i
		};

	</script>
	<script src="./script.js"></script>
</body>

</html>